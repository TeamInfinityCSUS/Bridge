<!-- DOCTYPE -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bridge: Home</title>
    <meta charset="utf-8">
    <!-- Viewport Meta Tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
  </head>
  <body>
    <h1> <!--Heading, includes Logo, Profile button, and other menu buttons -->
      Bridge
      <img src="images/defaultavatar.png" height = "40" width = "40" id = "hPic" class="rounded float-right" data-toggle = "modal" data-target="#Profile"><br />

	<div id = "studentB" class = "container hidden"> <!-- separating button groups by user type, will determine which one to show -->
	<button type="button" id ="etern" class="btn blue btn-sm">Eternships</button>
    <button type="button" id ="f5" class="btn blue btn-sm">Fab Five</button>
	</div>

	<div id = "creatorB" class = "container hidden">
	<button type="button" id = "mcon" class="btn blue btn-sm" data-toggle = "modal" data-target="#mConM">Manage Content</button>
	</div>

	<div id = "badminB" class = "container hidden">
	<button type="button" id = "mcon" class="btn blue btn-sm" data-toggle = "modal" data-target="#mConM">Manage Content</button>
    <button type="button" id="badmin" class="btn blue btn-sm">Manage Company</button>
	</div>
    <img src="images/settingsicon.png" height = "40" width = "40" id = "oPic" class="rounded float-right" data-toggle = "modal" data-target="#Settings">
  </h1>
  <div class="col col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12" id= "column"> <!-- Container for cards -->
	<div class="container" id ="videoList">

	</div>
  </div>
  <div class="modal fade" id="Profile" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true"> <!--Own user's profile page, similar to viewing another's profile-->
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header" id = "pHeader">
          <img src="images/defaultavatar.png" id = "pPic" class="img-thumbnail">
          <div class="modal-body">
            <h2 id="pName"></h2>
      </div>
      </div>
      <div class="modal-body">
        <div id = "Bio"></div>
		<h2 id = "pAffil"></h2> <!--School/Company -->
		<p id= "group"></p>
    <h2 id = "pDescrip1"></h2> <!--Primary Interest/Field -->
		<p id= "pInterest"></p>
    <h2 id = "pDescrip2"></h2> <!-- Secondary Interest/Creator Interests-->
		<p id= "sInterest"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn blue" id="ePB" data-toggle ="modal" data-target = "#eProfile">Edit</button>
      </div>
    </div>
    </div>
    </div>

	  <div class="modal fade" id="oProfile" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true"> <!-- modal used to view other users' profiles -->
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header" id = "pHeader">
          <img src="images/defaultavatar.png" id = "pPic" class="img-thumbnail">
          <div class="modal-body">
            <h2 id="poName"></h2>
      </div>
      </div>
      <div class="modal-body">
        <div id = "oBio"></div>
		<h2 id = "opAffil"></h2>
		<p id= "ogroup"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" id="rPB">Report</button>
        <button type="button" class="btn blue" id="fPB" data-toggle ="modal" data-target = "#eProfile">Follow</button>
      </div>
    </div>
    </div>
    </div>

    <div class="modal fade" id="eProfile" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true"> <!--Modal opened when user wants to edit profile, same as self profile but with editable bio -->
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header" id = "pHeader">
            <img src="images/defaultavatar.png" id = "pPic" class="img-thumbnail">
            <div class="modal-body">
              <h2 id="peName"></h2>
            </div>
          </div>
        <div class="modal-body">
          <input class="text input-lg" id ="newBio"></input>
		<h2 id = "peAffil"><br /><br /></h2>
		<p id= "egroup"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn blue" id ="sPB" data-dismiss="modal" data-toggle ="modal" data-target = "#Profile">Save</button>
        </div>
      </div>
      </div>
      </div>


	    <div class="modal fade" id="mConM" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document"> <!--Manage Content modal, can either view content already uploaded or upload a new one -->
      <div class="modal-content">
          <div class="modal-header">
            <h2>Manage Conent</h2>
      </div>

      <div class="modal-body">
	  <button type="button" class="btn blue" id="UC" data-toggle ="modal" data-target = "#uConM">Upload Content</button>
      </div>
	  </div>
    </div>
      <div class="modal-footer">
	  <button type="button" class="btn blue" id="viewC">View My Content</button>
	  <button type="button" class="btn blue" id="UC" data-toggle ="modal" data-target = "#uConM">Upload Content</button>
      </div>
	  </div>

	    <div class="modal fade" id="uConM" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content"> <!-- modal to upload content -->
          <div class="modal-header">
            <h2>Upload Content</h2>
      </div>
      <div class="modal-body">
		<div class="dropdown">
		<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		<div id= "uConType">Content Type</div>
		</button>
		<div class="dropdown-menu" aria-labelledby="Content Type">
			<a class="dropdown-item" id = "uMessage">Message</a>
			<a class="dropdown-item" id = "uVideo">Video</a>
			<a class="dropdown-item" id = "uAnn">Announcement</a>
		</div>
		</div>
	  <p>Youtube URL (For Videos)<input class = "text" id = "uURL"></input></p>
	  <p>Title (For Announcements and Videos)<input class = "text" id = "uTitle"></input></p>
	  <p>Description/Message<input class = "text" id = "uDescription"></input></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn blue" id="UC">Upload</button>
      </div>
    </div>
    </div>
  </div>

      <div class="modal fade" id="Settings" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
            <div class="modal-footer">
              <button type="button" class="btn blue"  id="cFieldB" data-dismiss="modal" data-toggle ="modal" data-target = "eProfile">Change Field</button><br />
              <button type="button" class="btn blue" id="logOutB" data-dismiss="modal">Log Out</button>
          </div>
          </div>
        </div>
        </div>
        </div>

		<!--Video Player -->
		<div class="modal fade" id="Player" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true"> <!-- Primitive video player, will open on clicking video cards -->
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
			<div id="vTitle"></div>

            <div class="modal-footer">
              <button type="button" class="btn blue"  id="reactB">React</button><br />
              <button type="button" class="btn blue" id="likeB">Like</button>
          </div>
          </div>
        </div>
        </div>
        </div>
	<style>
	h1{
		background-color: #1A7CBC;
    height: 90px;
	}
	body{
		background-color: #82CBFB;
	}
  .newProfile{
    height:500px;
    width: 500px;
  }
  .row{
    margin-bottom: 10px;
    margin-left: 10px;
  }
  .aBody{
    padding-bottom:5px;
    text-align: center;
  }
  .Settings{
      margin-bottom:5px;
  }
  .sBody{
    background-color: #FF33E3;
  }
  .Settings:active{

  }
  .pAffil:default{
    text-decoration-color: #FF33E3;

  }
  .hidden{
	display: none;
  }
  .modal-footer .btn{
     margin-top: 15px;
   }
  .blue{
    background-color:#5B5B5B;
  }
  .card{
    margin-bottom: 15px;
  }
  .viewp{
    color: blue;
  }
	</style>

		<!-- jQuery library -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

		<!-- Popper -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

		<!-- Latest compiled and minified Bootstrap JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <!--JQuery used for AJAX (communication between PHP and Javascript) -->
<script> //Javascript for the page here
var user;
var uType;
$(document).ready(function () {
  if (sessionStorage.getItem('profile_id') == null){ //if no session is detected, move to login page to create session
    window.location.href = 'index.html';
  }
  else{
    $("#creatorB").hide(); //initially hide all buttons, only one set will be shown after initialization
    $("#badminB").hide();
    $("#studentB").hide();
	var uName = sessionStorage.profile_id;
	//initial work
    $.post("php/home.php", {action:'init', name:uName}) //initial setup, runs on startup
    .done(function(data){
        user = JSON.parse(data); //fetch self information
        document.getElementById("pName").innerHTML = user[0].fname + " " + user[0].lname; //fill in self profile with information
        document.getElementById("peName").innerHTML = user[0].fname + " " + user[0].lname;
        document.getElementById("Bio").innerHTML = user[0].bio;
        if(user[0].acc_type == "Student"){ //change page based on user type (hide options, tweak profile, etc.)
          $('#studentB').show(); //show student buttons
          document.getElementById("pAffil").innerHTML = "School"; //show student's group as a school
          document.getElementById("group").innerHTML = user[0].school;
          document.getElementById("pDescrip1").innerHTML = "Primary Interest";
          document.getElementById("pInterest").innerHTML = user[0].primary_interest;
          document.getElementById("pDescrip2").innerHTML = "Secondary Interests";
          document.getElementById("sInterest").innerHTML = user[0].secondary_interest;
        }
        else if(user[0].acc_type == "Creator"){
          $("#creatorB").show(); //show creator buttons
          document.getElementById("pAffil").innerHTML = "Company"; //show creator's group as a company

          document.getElementById("group").innerHTML = user[0].company;
          document.getElementById("pDescrip1").innerHTML = "Field";
          document.getElementById("pInterest").innerHTML = user[0].field;
          document.getElementById("pDescrip2").innerHTML = "Interests";
          document.getElementById("sInterest").innerHTML = user[0].interests;
        }
		else if(user[0].acc_type == "Badmin"){
          $("#badminB").show(); //show creator buttons
          document.getElementById("pAffil").innerHTML = "Company"; //show creator's group as a company
          document.getElementById("group").innerHTML = user[0].company;
          document.getElementById("pDescrip1").innerHTML = "Field";
          document.getElementById("pInterest").innerHTML = user[0].field;
          document.getElementById("pDescrip2").innerHTML = "Interests";
          document.getElementById("sInterest").innerHTML = user[0].interests;
        }
        });
	  //generate content
      $.post("php/home.php", {action:'cards',name:uName}) //generates content cards, thumbnails for videos or posts, initally primitive
      .done(function(data){
        $('#videoList').append(data);
        });
  }
    $('#hPic').click(function onchange() { //click on to open own profile window
		  $("#newBio").val("");
      });
    $('#ePB').click(function onchange() { //fill in edit field with original bio, in case only minor edits are needed
          document.getElementById("newBio").innerHTML = user[0].bio;
      });

    $('#sPB').click(function onchange() { //replace old profile with new one, replace bio in database
		  var newB = $("#newBio").text(); //fetch input for new bio
		  $.post("php/home.php", {action:"eProfile", newBio:newB,name:uName})
		  document.getElementById("Bio").innerHTML = user[0].bio; //update bio to new bio
      });
   $('#uVideo, #uMessage, #uAnn').click(function onchange() { //if option is selected, make dropdown menu title the selection
     $("#uType").text($(this).text());
   });
	 $('#UC').click(function onchange() { //upload new content to database and to users
	    uType = $("#uType").text();
		  var uURL = $("#uURL").text(); //get URL,Title, and Description/message from input
		  var uTitle = $("#uTitle").text();
		  var uDesc = $("#uDescription").text();
      $.post("php/home.php", {action:"upload",type:uType, who:user[0].username, url: uURL, title: uTitle, desc: uDesc} )
      });
    $('#ePB').click(function onchange() { //fill in edit field with original bio, in case only minor edits are needed
          document.getElementById("newBio").innerHTML = " "
      });

    /*$('#sPB').click(function onchange() { //replace old profile with new one, replace bio in database
		  var newB = document.getElementById("newBio").text();
      $.post("php/home.php", {action:"eProfile", newBio:newB})
			.done(function(data){ //update profile live when finished
			document.getElementById("Bio").innerHTML = user[0].about_us;
			});

      });*/
    $('#logOutB').click(function onchange() { //clear session, return back to login page
          sessionStorage.clear();
          window.location.href = 'index.html';
      });

		});

</script>

  </body>
</html>
